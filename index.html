<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Begriffel</title>

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto;
  background:#fff;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}
.app{width:320px;text-align:center}
h1{margin:10px 0}
.sub{color:#777;margin-bottom:10px}

.board{
  display:grid;
  grid-template-rows:repeat(6,1fr);
  gap:8px;
  padding:12px;
  border:1px solid #eee;
  border-radius:16px;
}
.row{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}

.tile{
  aspect-ratio:1;
  perspective:800px;
}
.tileInner{
  width:100%;height:100%;
  border:2px solid #ddd;
  border-radius:12px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:28px;
  font-weight:900;
  transform-style:preserve-3d;
  transition:transform 860ms cubic-bezier(.2,.85,.2,1),
             background-color 200ms ease,
             border-color 200ms ease;
}
.tile.flipped .tileInner{transform:rotateX(180deg)}

.face{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  backface-visibility:hidden;
}
.back{transform:rotateX(180deg);color:transparent}

.tile.green .tileInner{background:#22c55e;border-color:#22c55e;color:#fff}
.tile.yellow .tileInner{background:#eab308;border-color:#eab308;color:#111}
.tile.gray .tileInner{background:#9ca3af;border-color:#9ca3af;color:#fff}

.kb{margin-top:12px}
.kbRow{display:grid;gap:6px;margin-bottom:6px}
.kbRow.first{grid-template-columns:repeat(10,1fr)}
.kbRow.second{grid-template-columns:repeat(9,1fr)}
.kbRow.third{grid-template-columns:1.4fr repeat(7,1fr) 1.4fr}
.key{
  height:42px;border-radius:10px;
  border:1px solid #ddd;
  background:#f3f4f6;
  font-weight:800;
  display:flex;align-items:center;justify-content:center;
}
.key.green{background:#22c55e;color:#fff}
.key.yellow{background:#eab308}
.key.gray{background:#9ca3af;color:#fff}
</style>
</head>

<body>
<div class="app">
  <h1>Begriffel</h1>
  <div class="sub">4 Buchstaben · 6 Versuche</div>

  <div class="board" id="board"></div>

  <div class="kb" id="kb">
    <div class="kbRow first">Q W E R T Z U I O P</div>
    <div class="kbRow second">A S D F G H J K L</div>
    <div class="kbRow third">ENTER Y X C V B N M ⌫</div>
  </div>
</div>

<script>
const ANSWER="PRIM";
const WORD_LEN=4;
const MAX_TRIES=6;

let row=0, col=0, current="";
let busy=false;
const tiles=[];
const board=document.getElementById("board");

for(let r=0;r<MAX_TRIES;r++){
  const rowEl=document.createElement("div");
  rowEl.className="row";
  tiles[r]=[];
  for(let c=0;c<WORD_LEN;c++){
    const t=document.createElement("div");
    t.className="tile";
    t.innerHTML=`
      <div class="tileInner">
        <div class="face front"></div>
        <div class="face back"></div>
      </div>`;
    rowEl.appendChild(t);
    tiles[r][c]=t;
  }
  board.appendChild(rowEl);
}

function setTileText(r,c,ch){
  tiles[r][c].querySelector(".front").textContent=ch||"";
}

function evaluate(g,a){
  const res=Array(WORD_LEN).fill("gray");
  const A=a.split(""), G=g.split("");
  for(let i=0;i<WORD_LEN;i++){
    if(G[i]===A[i]){res[i]="green";A[i]=null;G[i]=null;}
  }
  for(let i=0;i<WORD_LEN;i++){
    if(G[i] && A.includes(G[i])){
      res[i]="yellow";A[A.indexOf(G[i])]=null;
    }
  }
  return res;
}

async function reveal(guess){
  busy=true;
  const colors=evaluate(guess,ANSWER);
  const flipMs=860, perDelay=220;
  const midFlip=Math.round(flipMs*0.5)-20;

  for(let c=0;c<WORD_LEN;c++) setTileText(row,c,guess[c]);

  for(let c=0;c<WORD_LEN;c++){
    const t=tiles[row][c];
    setTimeout(()=>{
      t.classList.add("flipped");
      setTimeout(()=>t.classList.add(colors[c]),midFlip);
    },c*perDelay);
  }

  await new Promise(r=>setTimeout(r,(WORD_LEN-1)*perDelay+flipMs));
  row++; col=0; current="";
  busy=false;
}

document.addEventListener("keydown",e=>{
  if(busy) return;
  if(e.key==="Enter" && current.length===WORD_LEN) reveal(current);
  if(e.key==="Backspace" && col>0){
    col--; current=current.slice(0,-1);
    setTileText(row,col,"");
  }
  if(/^[a-zA-Z]$/.test(e.key) && col<WORD_LEN){
    current+=e.key.toUpperCase();
    setTileText(row,col,e.key.toUpperCase());
    col++;
  }
});
</script>
</body>
</html>